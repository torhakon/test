name: Test workflow
on:
  workflow_dispatch:
jobs:
  checkoutAndCommit:
    runs-on: ubuntu-latest
    name: Check out and commit
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v4
      - name: Try update
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "Try to update and commit file!"
          printf  "\nhello" >> MyFile.txt
          # git add .
          # git commit -m "Commit from bot"
          # git push
          echo "GITHUB_REPOSITORY is $GITHUB_REPOSITORY"
          echo "GITHUB_REF_NAME is $GITHUB_REF_NAME"
          echo "github.repository is ${{ github.repository }}"
          echo "github.ref_name is ${{ github.ref_name }}"
          gh api graphql -F githubRepository="${{ github.repository }}" \
                         -F branchName="${{ github.ref_name }}" \
                         -F expectedHeadOid="$(git rev-parse HEAD)" \
                         -F commitMessage="Commit from bot" \
                         -F files[][path]="MyFile.txt" \
                         -F files[][contents]="$(base64 -w0 MyFile.txt)" \
                         -F 'query=@.github/api/createCommitOnBranch.gql'